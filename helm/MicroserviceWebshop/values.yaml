name: avalon-ingress

services:
  mssql:
    name: mssql
    port: 2666
  basket_service:
    name: basket-service
    port: 80
    prefix: /api/basket
  nginx_frontend:
    name: nginx-frontend
    port: 80
    prefix: /
  product_service:
    name: product-service
    port: 80
    prefix: /products

dependencies:
  mssql:
    endabled: true
  basket-service:
    enabled: true
  nginx-frontend:
    enabled: true
  product-service:
    enabled: true
  traefik:
    enabled: true

basket-service:
  deployment:
    image: "basket-service"
    registry: "mswsregistry.azurecr.io"
    tag: "latest"
    containerPort: 80
  name: "basket"

nginx-frontend:
  deployment:
    image: "nginx-frontend"
    registry: "mswsregistry.azurecr.io"
    tag: "latest"
    containerPort: 80
  name: "nginx-frontend"

product-service:
  deployment:
    image: "product-service"
    registry: "mswsregistry.azurecr.io"
    tag: "latest"
    containerPort: 80
  name: "product-service"

mssql:
  deployment:
    image: "mcr.microsoft.com/mssql/server:2019-latest"
    containerPort: 1433
  name: "mssql"

  # database:
  #   url: mongodb://user1:user123@mongodb-svc.mongodb/Archimedes-Rest?readPreference=primaryPreferred